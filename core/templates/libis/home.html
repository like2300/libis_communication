{% extends "base.html" %}
{% comment %} pge home.html {% endcomment %} 

{% block content %} 
    <style>
        @keyframes reveal {
            from {
                clip-path: inset(0 100% 0 0);
            }
            to {
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes textReveal {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes shine {
            from {
                transform: translateX(-100%) rotate(45deg);
            }
            to {
                transform: translateX(200%) rotate(45deg);
            }
        }

        .shine-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            transform: translateX(-100%) rotate(45deg);
        }

        .shine-effect:hover::before {
            animation: shine 1.5s;
        }

        .float-animation {
            animation: float 6s ease-in-out infinite;
        }

        .split-reveal {
            animation: reveal 1.2s cubic-bezier(0.77, 0, 0.175, 1);
        }

        .text-reveal {
            animation: textReveal 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }

        .scroll-container {
            scroll-snap-type: y mandatory;
            -webkit-overflow-scrolling: touch;
        }

        .scroll-section {
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }

        .content-mask {
            -webkit-mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
            mask-image: linear-gradient(to bottom, black 80%, transparent 100%);
        }
    </style>
</head>
<body class="bg-neutral-950 text-white overflow-hidden">
    <!-- Main scroll container -->
    <!-- templates/libis/home.html -->
{% load static %}

<div class="scroll-container h-screen overflow-y-auto overflow-x-hidden">
    {% for message in messages %}
    <!-- Section {{ forloop.counter }} -->
    <section class="scroll-section relative h-screen flex flex-col md:flex-row">
        {% if forloop.counter|divisibleby:2 %}
            <!-- Even sections (2, 4, etc.) - Text on left, media on right -->
            <!-- Right content -->
            <div class="w-full md:w-1/2 h-1/2 md:h-full flex items-center justify-center p-8 bg-neutral-900">
                <div class="max-w-lg float-animation">
                    <span class="text-neutral-400 tracking-wider text-sm font-mono">0{{ forloop.counter }} / MESSAGE</span>
                    <h2 class="mt-4 text-5xl md:text-7xl font-bold leading-none bg-gradient-to-r from-white to-neutral-400 bg-clip-text text-transparent">{{ message.titre }}</h2>
                    <p class="mt-6 text-neutral-400 text-lg leading-relaxed">{{ message.contenu }}</p>
                    <button class="mt-8 px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full text-sm font-medium transition-all duration-300 hover:tracking-wider">En savoir plus →</button>
                </div>
            </div>
            <!-- Left content -->
            <div class="w-full md:w-1/2 h-1/2 md:h-full relative overflow-hidden group shine-effect">
                {% if message.media %}
                    {% if message.media.url|lower|slice:'-4:' == '.mp4' or message.media.url|lower|slice:'-5:' == '.webm' %}
                        <video autoplay loop muted class="absolute inset-0 w-full h-full object-cover transition-all duration-1000 group-hover:scale-110 group-hover:rotate-1">
                            <source src="{{ message.media.url }}" type="video/mp4">
                        </video>
                    {% else %}
                        <img src="{{ message.media.url }}" 
                             alt="{{ message.titre }}" 
                             class="absolute inset-0 w-full h-full object-cover transition-all duration-1000 group-hover:scale-110 group-hover:rotate-1" />
                    {% endif %}
                {% else %}
                    <div class="absolute inset-0 bg-neutral-800 flex items-center justify-center">
                        <span class="text-neutral-500">Aucun média</span>
                    </div>
                {% endif %}
                <div class="absolute inset-0 bg-gradient-to-l from-neutral-950/70 to-neutral-950/50 transition-opacity duration-500 group-hover:opacity-0"></div>
            </div>
        {% else %}
            <!-- Odd sections (1, 3, etc.) - Media on left, text on right -->
            <!-- Left content -->
            <div class="w-full md:w-1/2 h-1/2 md:h-full relative overflow-hidden group shine-effect">
                {% if message.media %}
                    {% if message.media.url|lower|slice:'-4:' == '.mp4' or message.media.url|lower|slice:'-5:' == '.webm' %}
                        <video autoplay loop muted class="absolute inset-0 w-full h-full object-cover transition-all duration-1000 group-hover:scale-110 group-hover:rotate-1">
                            <source src="{{ message.media.url }}" type="video/mp4">
                        </video>
                    {% else %}
                        <img src="{{ message.media.url }}" 
                             alt="{{ message.titre }}" 
                             class="absolute inset-0 w-full h-full object-cover transition-all duration-1000 group-hover:scale-110 group-hover:rotate-1" />
                    {% endif %}
                {% else %}
                    <div class="absolute inset-0 bg-neutral-800 flex items-center justify-center">
                        <span class="text-neutral-500">Aucun média</span>
                    </div>
                {% endif %}
                <div class="absolute inset-0 bg-gradient-to-r from-neutral-950/70 to-neutral-950/50 transition-opacity duration-500 group-hover:opacity-0"></div>
            </div>
            <!-- Right content -->
            <div class="w-full md:w-1/2 h-1/2 md:h-full flex items-center justify-center p-8 bg-neutral-950">
                <div class="max-w-lg float-animation">
                    <span class="text-neutral-400 tracking-wider text-sm font-mono">0{{ forloop.counter }} / MESSAGE</span>
                    <h2 class="mt-4 text-5xl md:text-7xl font-bold leading-none bg-gradient-to-r from-white to-neutral-400 bg-clip-text text-transparent">{{ message.titre }}</h2>
                    <p class="mt-6 text-neutral-400 text-lg leading-relaxed">{{ message.contenu }}</p>
                    <button class="mt-8 px-6 py-3 bg-white/10 hover:bg-white/20 rounded-full text-sm font-medium transition-all duration-300 hover:tracking-wider">En savoir plus →</button>
                </div>
            </div>
        {% endif %}
    </section>
    {% endfor %}

    <!-- Team Section (using your TeamMember model) -->
    <section class="scroll-section relative h-screen flex items-center justify-center bg-neutral-950">
        <div class="container mx-auto px-8">
            <h2 class="text-4xl md:text-6xl font-bold text-center mb-16 bg-gradient-to-r from-white to-neutral-400 bg-clip-text text-transparent">Notre Équipe</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                {% for member in equipe %}
                <div class="group relative overflow-hidden rounded-lg shine-effect">
                    <div class="relative h-96 overflow-hidden">
                        <img src="{{ member.photo.url }}" 
                             alt="{{ member.nom }}" 
                             class="w-full h-full object-cover transition-all duration-1000 group-hover:scale-110" />
                        <div class="absolute inset-0 bg-gradient-to-t from-neutral-950 via-neutral-950/20 to-transparent"></div>
                    </div>
                    <div class="absolute bottom-0 left-0 p-6 w-full">
                        <h3 class="text-2xl font-bold text-white">{{ member.nom }}</h3>
                        <p class="text-neutral-400">{{ member.poste }}</p>
                        <p class="mt-2 text-neutral-300 text-sm line-clamp-2">{{ member.bio }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Navigation dots -->
    <div class="fixed right-8 top-1/2 -translate-y-1/2 flex flex-col gap-4 z-50">
        {% for message in messages %}
        <button onclick="scrollToSection({{ forloop.counter0 }})" class="w-3 h-3 rounded-full bg-white/20 hover:bg-white transition-colors hover:scale-150" title="Aller à la section {{ forloop.counter }}"></button>
        {% endfor %}
        <button onclick="scrollToSection({{ messages|length }})" class="w-3 h-3 rounded-full bg-white/20 hover:bg-white transition-colors hover:scale-150" title="Aller à l'équipe"></button>
    </div>
</div>

    <script>
        const container = document.querySelector('.scroll-container');
        const sections = document.querySelectorAll('.scroll-section');
        const dots = document.querySelectorAll('.fixed.right-8 button');
        let isScrolling = false;

        function scrollToSection(index) {
            if (!isScrolling) {
                isScrolling = true;
                sections[index].scrollIntoView({ behavior: 'smooth' });
                updateDots(index);
                setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            }
        }

        function updateDots(index) {
            dots.forEach((dot, i) => {
                dot.className = `w-3 h-3 rounded-full transition-all duration-300 ${
                    i === index ? 'bg-white scale-150' : 'bg-white/20 hover:bg-white hover:scale-150'
                }`;
            });
        }

        // Update dots on scroll
        container.addEventListener('scroll', () => {
            const index = Math.round(container.scrollTop / window.innerHeight);
            updateDots(index);
        });

        // Initialize first dot
        updateDots(0);
    </script>
</body>
</html>
{% endblock %}